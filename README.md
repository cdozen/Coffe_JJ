sync  JJ code with NNU
